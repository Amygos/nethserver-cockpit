{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"NethServer Cockpit developer guide This guide describes how Cockpit is used inside NethServer and how to develop a new NethServer Cockpit module. Guidelines Developer environment API guidelines UI guidelines References Application manifest Build Building RPM Building documentation Create new module If you haven't used Cockpit before, be sure to check out the Cockpit Guide , as it explains Cockpit foundamentals. Once you're familiar with that process, you may proceed with this guide. To start the development of new NethServer Cockpit module: Read project Guidelines Prepare the Environment Scaffold your application","title":"Home"},{"location":"#nethserver-cockpit-developer-guide","text":"This guide describes how Cockpit is used inside NethServer and how to develop a new NethServer Cockpit module.","title":"NethServer Cockpit developer guide"},{"location":"#guidelines","text":"Developer environment API guidelines UI guidelines","title":"Guidelines"},{"location":"#references","text":"Application manifest","title":"References"},{"location":"#build","text":"Building RPM Building documentation","title":"Build"},{"location":"#create-new-module","text":"If you haven't used Cockpit before, be sure to check out the Cockpit Guide , as it explains Cockpit foundamentals. Once you're familiar with that process, you may proceed with this guide. To start the development of new NethServer Cockpit module: Read project Guidelines Prepare the Environment Scaffold your application","title":"Create new module"},{"location":"api_guidelines/","text":"Design guidelines Each cockpit module has its own helpers implementing a set API to read and write the configuration and to execute actions. All helpers are saved inside /usr/libexec/nethserver/api/ controller_name / directory. Each helper: must be an executable file, it can be written in any language depending on the task Example: /usr/libexec/nethserver/system-openssh/read . uses JSON format for input and output; the JSON can must be read as input from STDIN and printed to STDOUT can use other helpers to execute multiple actions, the helpers can be placed in the same directory (eg. /usr/libexec/nethserver/openssh/help1-read ) The JavaScript controller uses the cockpit.spawn method to communicate with the backend. After spawning the process, the controller gather the standard output to track the task progress. At the end, the process exit code will raise an error or a success. Example: process = cockpit . spawn ( /usr/libexec/nethserver/system-status/read , { ... } Methods APIs should implement classical CRUD operations, plus a validation helper: create read update delete validate None of the above action is mandatory. create Create a new record and apply the configuration. It's used to handle new records inside databases to mimic a table behavior. The input should be a JSON esmith record . Example: system-hosts . read Read the current system status and configuration. It should return an object with system and configuration field. JSON format: { status : { ... } configuration : { ... } } Example: system-openssh . update Update and existing record or a key inside the configuration database and apply the configuration. Example: system-openssh . delete Delete and existing record and apply the configuration. Example: system-hosts . validate Validate the given input. If validation fail, raise a validation error and exit 1. Otherwise return a success and exit 0. Documentation When creating new helpers, remember to write the related documentation. Download the template and edit it Add the new document inside the docs/docs/api directory Add the new document inside the navigation menu Try to respect the following rules: always use a correct header level add examples to you documentation enable syntax highlighting for code See also building documementation .","title":"Design guidelines"},{"location":"api_guidelines/#design-guidelines","text":"Each cockpit module has its own helpers implementing a set API to read and write the configuration and to execute actions. All helpers are saved inside /usr/libexec/nethserver/api/ controller_name / directory. Each helper: must be an executable file, it can be written in any language depending on the task Example: /usr/libexec/nethserver/system-openssh/read . uses JSON format for input and output; the JSON can must be read as input from STDIN and printed to STDOUT can use other helpers to execute multiple actions, the helpers can be placed in the same directory (eg. /usr/libexec/nethserver/openssh/help1-read ) The JavaScript controller uses the cockpit.spawn method to communicate with the backend. After spawning the process, the controller gather the standard output to track the task progress. At the end, the process exit code will raise an error or a success. Example: process = cockpit . spawn ( /usr/libexec/nethserver/system-status/read , { ... }","title":"Design guidelines"},{"location":"api_guidelines/#methods","text":"APIs should implement classical CRUD operations, plus a validation helper: create read update delete validate None of the above action is mandatory.","title":"Methods"},{"location":"api_guidelines/#create","text":"Create a new record and apply the configuration. It's used to handle new records inside databases to mimic a table behavior. The input should be a JSON esmith record . Example: system-hosts .","title":"create"},{"location":"api_guidelines/#read","text":"Read the current system status and configuration. It should return an object with system and configuration field. JSON format: { status : { ... } configuration : { ... } } Example: system-openssh .","title":"read"},{"location":"api_guidelines/#update","text":"Update and existing record or a key inside the configuration database and apply the configuration. Example: system-openssh .","title":"update"},{"location":"api_guidelines/#delete","text":"Delete and existing record and apply the configuration. Example: system-hosts .","title":"delete"},{"location":"api_guidelines/#validate","text":"Validate the given input. If validation fail, raise a validation error and exit 1. Otherwise return a success and exit 0.","title":"validate"},{"location":"api_guidelines/#documentation","text":"When creating new helpers, remember to write the related documentation. Download the template and edit it Add the new document inside the docs/docs/api directory Add the new document inside the navigation menu Try to respect the following rules: always use a correct header level add examples to you documentation enable syntax highlighting for code See also building documementation .","title":"Documentation"},{"location":"api_libraries/","text":"Helper libraries The nethserver-cockpit RPM includes some simple libraries to ease the development of helpers. Usage of such libraries is not mandatory. PHP This library includes some classes from NethGUI framework to speed up the porting of existing code. PHP helper library is useful to quickly adapt validation code from old Server Manager. Include the library: ?php require_once ( /usr/libexec/nethserver/api/lib/Helpers.php ); Available functions readInput Read the JSON input and return a named array. Example: ?php $data = readInput (); print $data [ name ]; EsmithDatabase Access the Esmith database. Example: ?php $db = new EsmithDatabase ( configuration ); $policy = $db - getProp ( tls , policy ); $tls = $db - getKey ( tls ); $records = $db - getAll (); LegacyValidator Interface to old validator code. See below. Legacy validator When using the LegacyValidator class, you should follow some rules which ease the cut paste from legacy code. General workflow: Include the helper Read the input Create the validator (calling it $v ) Copy all declareParameter invocations from the old Module Parameters with ANYTHING validator could be omitted Replace all call to $this with $v Make sure the first parameter of declareParameter is the name of the prop inside the db (Optional) Remove the 3rd argument from declareParameter calls If present, copy validate function. It should be enough to copy the code inside if ($this- getRequest()- isMutation()) { condition. Replace all $this with $v Validate the input calling $v- validate() Invoke success() method if validate() returns true Otherwise invoke error($v) passing the validator object Full example: ?php # Include library require_once ( /usr/libexec/nethserver/api/lib/Helpers.php ); # Read input $data = readInput (); # Create the validator $v = new LegacyValidator ( $data [ props ]); # Declare all parameters $v - declareParameter ( PasswordAuthentication , Validate :: BOOLEAN ); # Validate the input if ( $v - validate ()) { success (); } else { error ( $v ); } Perl To write better code, always enable warnings and strict checks: use warnings ; use strict ; Include the library: require /usr/libexec/nethserver/api/lib/helper_functions.pl ; Available functions success Print a success JSON object and exit 0. error Print a JSON error and exit 1. Takes 2 arguments: - the error type (default: GenericError) - a message (default \"Generic error\") Example: error ( GenericError , System message failure ); readInput Read JSON input from STDIN Exit with InvalidInput error if JSON can't be decoded. Example: my $data = readInput (); print $data - { name }; General examples Output sshd key in json output: use JSON ; use esmith::db ; my $db = esmith::db - open ( configuration ); print to_json ( $db - prepare_json ( sshd ), { utf8 = 1 , pretty = 0 , allow_nonref = 1 }); Alternative implementation: use JSON ; use esmith::ConfigDB ; my $db = esmith::ConfigDB - open_ro (); my $record = $db - get ( sshd ); my %props = $record - props ; print encode_json ({ name = $record - key , type = $record - prop ( type ), props = \\ %props }); BASH BASH is useful when writing simple helpers. First, include the library: . /usr/libexec/nethserver/api/lib/helper_functions Available functions success Print a success JSON object and exit 0. error Print a JSON error and exit 1. Takes 2 arguments: the error type (default: GenericError) a message (default \"Generic error\") Example: error GenericError System failure message invalid_error Print an InvalidInput error and exit 1. General examples Read JSON from STDIN and set the record: cat /dev/stdin | /sbin/e-smith/config setjson - 2 /dev/null Output sshd key in json output: /sbin/e-smith/config getjson sshd","title":"Helper libraries"},{"location":"api_libraries/#helper-libraries","text":"The nethserver-cockpit RPM includes some simple libraries to ease the development of helpers. Usage of such libraries is not mandatory.","title":"Helper libraries"},{"location":"api_libraries/#php","text":"This library includes some classes from NethGUI framework to speed up the porting of existing code. PHP helper library is useful to quickly adapt validation code from old Server Manager. Include the library: ?php require_once ( /usr/libexec/nethserver/api/lib/Helpers.php );","title":"PHP"},{"location":"api_libraries/#available-functions","text":"readInput Read the JSON input and return a named array. Example: ?php $data = readInput (); print $data [ name ]; EsmithDatabase Access the Esmith database. Example: ?php $db = new EsmithDatabase ( configuration ); $policy = $db - getProp ( tls , policy ); $tls = $db - getKey ( tls ); $records = $db - getAll (); LegacyValidator Interface to old validator code. See below.","title":"Available functions"},{"location":"api_libraries/#legacy-validator","text":"When using the LegacyValidator class, you should follow some rules which ease the cut paste from legacy code. General workflow: Include the helper Read the input Create the validator (calling it $v ) Copy all declareParameter invocations from the old Module Parameters with ANYTHING validator could be omitted Replace all call to $this with $v Make sure the first parameter of declareParameter is the name of the prop inside the db (Optional) Remove the 3rd argument from declareParameter calls If present, copy validate function. It should be enough to copy the code inside if ($this- getRequest()- isMutation()) { condition. Replace all $this with $v Validate the input calling $v- validate() Invoke success() method if validate() returns true Otherwise invoke error($v) passing the validator object Full example: ?php # Include library require_once ( /usr/libexec/nethserver/api/lib/Helpers.php ); # Read input $data = readInput (); # Create the validator $v = new LegacyValidator ( $data [ props ]); # Declare all parameters $v - declareParameter ( PasswordAuthentication , Validate :: BOOLEAN ); # Validate the input if ( $v - validate ()) { success (); } else { error ( $v ); }","title":"Legacy validator"},{"location":"api_libraries/#perl","text":"To write better code, always enable warnings and strict checks: use warnings ; use strict ; Include the library: require /usr/libexec/nethserver/api/lib/helper_functions.pl ;","title":"Perl"},{"location":"api_libraries/#available-functions_1","text":"success Print a success JSON object and exit 0. error Print a JSON error and exit 1. Takes 2 arguments: - the error type (default: GenericError) - a message (default \"Generic error\") Example: error ( GenericError , System message failure ); readInput Read JSON input from STDIN Exit with InvalidInput error if JSON can't be decoded. Example: my $data = readInput (); print $data - { name };","title":"Available functions"},{"location":"api_libraries/#general-examples","text":"Output sshd key in json output: use JSON ; use esmith::db ; my $db = esmith::db - open ( configuration ); print to_json ( $db - prepare_json ( sshd ), { utf8 = 1 , pretty = 0 , allow_nonref = 1 }); Alternative implementation: use JSON ; use esmith::ConfigDB ; my $db = esmith::ConfigDB - open_ro (); my $record = $db - get ( sshd ); my %props = $record - props ; print encode_json ({ name = $record - key , type = $record - prop ( type ), props = \\ %props });","title":"General examples"},{"location":"api_libraries/#bash","text":"BASH is useful when writing simple helpers. First, include the library: . /usr/libexec/nethserver/api/lib/helper_functions","title":"BASH"},{"location":"api_libraries/#available-functions_2","text":"success Print a success JSON object and exit 0. error Print a JSON error and exit 1. Takes 2 arguments: the error type (default: GenericError) a message (default \"Generic error\") Example: error GenericError System failure message invalid_error Print an InvalidInput error and exit 1.","title":"Available functions"},{"location":"api_libraries/#general-examples_1","text":"Read JSON from STDIN and set the record: cat /dev/stdin | /sbin/e-smith/config setjson - 2 /dev/null Output sshd key in json output: /sbin/e-smith/config getjson sshd","title":"General examples"},{"location":"api_protocol/","text":"Communication protocol The API and the UI talk to each other using JSON and the communication protocol defines a set of a well-known objects. Esmith db records Objects passed to and returned by APIs must reflect esmith db format and respect the upper/lower case notation of property names: { name : keyname , type : typename , props : { FirstProp : FirstPropValue , ... } } Please note that name and type field are reserved. Example Host goofy inside the hosts database. Original esmith db notation: goofy=local Description=Goofy workstation IpAddress=192.168.1.22 Equivalent JSON notation: { name : goofy , type : local , props : { Description : Goofy workstation , IpAddress : 192.168.1.22 } } Events If invoked with -j option, the signal-event command outputs the event progress in JSON format. Example: { steps : 2 , pid : 17354 , args : , event : nethserver-lsm-save } { step : 1 , pid : 17354 , action : S05generic_template_expand , event : nethserver-lsm-save , state : running } { progress : 0.50 , time : 0.21036 , exit : 0 , event : nethserver-lsm-save , state : done , step : 1 , pid : 17354 , action : S05generic_template_expand } { step : 2 , pid : 17354 , action : S90adjust-services , event : nethserver-lsm-save , state : running } { progress : 1.00 , time : 0.685865 , exit : 0 , event : nethserver-lsm-save , state : done , step : 2 , pid : 17354 , action : S90adjust-services } { pid : 17354 , status : success , event : nethserver-lsm-save } Special fields: steps: set the total number of event actions step: identify the current running step progress: percentage of event completion status: can be success or failed in case of failure Success Simple success message: { state : success } Errors If something goes wrong, APIs must output a JSON object which describes the error reason. For instance: { id : 1507721123244 , type : Error , message : Generic error reason , attributes : { output : output from the system } } The message property should be used if an error is not caused by a specific attribute. On the other hand, there could be cases where the attributes object is empty, or undefined because the error condition does not depend on any of the attributes or attributes are not defined at all. Note that the same Error object could represent multiple failure reasons. The id field should be a unique identifier like a timestamp. Bash example: $ date +%s Well-known errors The list of well-known errors includes: validation event failure invalid input Validation Validation error: { id : 1536738091 , type : NotValid , message : Validation failed , attributes : [ { parameter : name , value : test4 , error : valid_hostname_fqdn } ] } Event failure Event has failed: { id : 1536738278 , type : EventFailed , message : See /var/log/messages } Invalid input Invalid JSON object input: { id : 1536738276 , type : InvalidInput , message : No JSON data available }","title":"Communication protocol"},{"location":"api_protocol/#communication-protocol","text":"The API and the UI talk to each other using JSON and the communication protocol defines a set of a well-known objects.","title":"Communication protocol"},{"location":"api_protocol/#esmith-db-records","text":"Objects passed to and returned by APIs must reflect esmith db format and respect the upper/lower case notation of property names: { name : keyname , type : typename , props : { FirstProp : FirstPropValue , ... } } Please note that name and type field are reserved.","title":"Esmith db records"},{"location":"api_protocol/#example","text":"Host goofy inside the hosts database. Original esmith db notation: goofy=local Description=Goofy workstation IpAddress=192.168.1.22 Equivalent JSON notation: { name : goofy , type : local , props : { Description : Goofy workstation , IpAddress : 192.168.1.22 } }","title":"Example"},{"location":"api_protocol/#events","text":"If invoked with -j option, the signal-event command outputs the event progress in JSON format. Example: { steps : 2 , pid : 17354 , args : , event : nethserver-lsm-save } { step : 1 , pid : 17354 , action : S05generic_template_expand , event : nethserver-lsm-save , state : running } { progress : 0.50 , time : 0.21036 , exit : 0 , event : nethserver-lsm-save , state : done , step : 1 , pid : 17354 , action : S05generic_template_expand } { step : 2 , pid : 17354 , action : S90adjust-services , event : nethserver-lsm-save , state : running } { progress : 1.00 , time : 0.685865 , exit : 0 , event : nethserver-lsm-save , state : done , step : 2 , pid : 17354 , action : S90adjust-services } { pid : 17354 , status : success , event : nethserver-lsm-save } Special fields: steps: set the total number of event actions step: identify the current running step progress: percentage of event completion status: can be success or failed in case of failure","title":"Events"},{"location":"api_protocol/#success","text":"Simple success message: { state : success }","title":"Success"},{"location":"api_protocol/#errors","text":"If something goes wrong, APIs must output a JSON object which describes the error reason. For instance: { id : 1507721123244 , type : Error , message : Generic error reason , attributes : { output : output from the system } } The message property should be used if an error is not caused by a specific attribute. On the other hand, there could be cases where the attributes object is empty, or undefined because the error condition does not depend on any of the attributes or attributes are not defined at all. Note that the same Error object could represent multiple failure reasons. The id field should be a unique identifier like a timestamp. Bash example: $ date +%s","title":"Errors"},{"location":"api_protocol/#well-known-errors","text":"The list of well-known errors includes: validation event failure invalid input","title":"Well-known errors"},{"location":"api_protocol/#validation","text":"Validation error: { id : 1536738091 , type : NotValid , message : Validation failed , attributes : [ { parameter : name , value : test4 , error : valid_hostname_fqdn } ] }","title":"Validation"},{"location":"api_protocol/#event-failure","text":"Event has failed: { id : 1536738278 , type : EventFailed , message : See /var/log/messages }","title":"Event failure"},{"location":"api_protocol/#invalid-input","text":"Invalid JSON object input: { id : 1536738276 , type : InvalidInput , message : No JSON data available }","title":"Invalid input"},{"location":"api_template/","text":"module-name Short module description read Output Describe JSON output here: { ... } validate Constraints Constraint 1 Constraint 2 ... Input Describe input here. Input example: { .... } Invocation example: echo ... | command update Update input description. Use subtitles to describe multiple update actions. delete Delete input description. create Create input description.","title":"module-name"},{"location":"api_template/#module-name","text":"Short module description","title":"module-name"},{"location":"api_template/#read","text":"","title":"read"},{"location":"api_template/#output","text":"Describe JSON output here: { ... }","title":"Output"},{"location":"api_template/#validate","text":"","title":"validate"},{"location":"api_template/#constraints","text":"Constraint 1 Constraint 2 ...","title":"Constraints"},{"location":"api_template/#input","text":"Describe input here. Input example: { .... } Invocation example: echo ... | command","title":"Input"},{"location":"api_template/#update","text":"Update input description. Use subtitles to describe multiple update actions.","title":"update"},{"location":"api_template/#delete","text":"Delete input description.","title":"delete"},{"location":"api_template/#create","text":"Create input description.","title":"create"},{"location":"application_manifest/","text":"Application manifest Applications are described by a JSON manifest inspired to AppData and NPM package.json formats. The manifest is used both for generating the \"Applications\" page and for a future App store. Manifest must be placed under /usr/share/cockpit/nethserver/applications directory and named with the application id like id .json ; Format id : this tag contains the unique identifier for this application (required) name : descriptive name of the application (required) summary : describe what is the purpose of the application in few words (required) description : include 2-3 paragraphs describing any important features. Each line should be an element of the array. Supports markdown format. (recommended) icon : name of the icon file; the icon should be 256x256px (recommended) screenshots : a list of screenshots; all screenshots should have a 16:9 aspect ratio, and should have a width that is no smaller than 620px (optional) url : link to local application installation. (required for web applications) homepage : this is a recommended tag for link project official site (optional) release : define the version and release date of this application (recommended) provides : list of provided RPM packages (optional) tags : list of keywords to help people discover content of the application (optional) license : license of the application, please pick one from SPDX list (recommended) bugs : the url of project's issue tracker and / or the email address to which issues should be reported (optional) author : the name of of the author with optional email and urls fields. (recommended) Images like screenshots and icons must be placed under /usr/share/cockpit/ application-id /assets directory. Example File /usr/share/cockpit/nethserver/applications/nextcloud.json : { id : nethserver-netxtcloud , name : NextCloud , summary : Share your data , description : [ Access, **share** and protect your files, calendars, contacts, communication more at home and in your enterprise. , Nextcloud puts your data at your fingertips, under your control. ], icon : icon.png , screenshots : [ { caption : Login , image : login.png }, { caption : Share data , image : data.png } ], url : /nextcloud , homepage : http://www.nextcloud.org , provides : [ nextcloud , nethserver-nextcloud ], release : { version : 12.0.2 }, tags : [ cloud , files , share ], license : GPL-3.0 , bugs : { url : https://github.com/owner/project/issues , email : project@hostname.com }, author : { name : Nextcloud , url : https://nextcloud.com , email : info@nextcloud.com } }","title":"Application manifest"},{"location":"application_manifest/#application-manifest","text":"Applications are described by a JSON manifest inspired to AppData and NPM package.json formats. The manifest is used both for generating the \"Applications\" page and for a future App store. Manifest must be placed under /usr/share/cockpit/nethserver/applications directory and named with the application id like id .json ;","title":"Application manifest"},{"location":"application_manifest/#format","text":"id : this tag contains the unique identifier for this application (required) name : descriptive name of the application (required) summary : describe what is the purpose of the application in few words (required) description : include 2-3 paragraphs describing any important features. Each line should be an element of the array. Supports markdown format. (recommended) icon : name of the icon file; the icon should be 256x256px (recommended) screenshots : a list of screenshots; all screenshots should have a 16:9 aspect ratio, and should have a width that is no smaller than 620px (optional) url : link to local application installation. (required for web applications) homepage : this is a recommended tag for link project official site (optional) release : define the version and release date of this application (recommended) provides : list of provided RPM packages (optional) tags : list of keywords to help people discover content of the application (optional) license : license of the application, please pick one from SPDX list (recommended) bugs : the url of project's issue tracker and / or the email address to which issues should be reported (optional) author : the name of of the author with optional email and urls fields. (recommended) Images like screenshots and icons must be placed under /usr/share/cockpit/ application-id /assets directory.","title":"Format"},{"location":"application_manifest/#example","text":"File /usr/share/cockpit/nethserver/applications/nextcloud.json : { id : nethserver-netxtcloud , name : NextCloud , summary : Share your data , description : [ Access, **share** and protect your files, calendars, contacts, communication more at home and in your enterprise. , Nextcloud puts your data at your fingertips, under your control. ], icon : icon.png , screenshots : [ { caption : Login , image : login.png }, { caption : Share data , image : data.png } ], url : /nextcloud , homepage : http://www.nextcloud.org , provides : [ nextcloud , nethserver-nextcloud ], release : { version : 12.0.2 }, tags : [ cloud , files , share ], license : GPL-3.0 , bugs : { url : https://github.com/owner/project/issues , email : project@hostname.com }, author : { name : Nextcloud , url : https://nextcloud.com , email : info@nextcloud.com } }","title":"Example"},{"location":"build_doc/","text":"Building documentation This guide has been built using MkDocs and Material for MKDocs . Follow mkdocs installation instructions , or just use: pip install --user mkdocs mkdocs-material To serve the documentation during the development use: cd docs mkdocs serve Publish to GitHub pages To build and public the documentation directly to GitHub pages: cd docs mkdocs gh-deploy","title":"Building documentation"},{"location":"build_doc/#building-documentation","text":"This guide has been built using MkDocs and Material for MKDocs . Follow mkdocs installation instructions , or just use: pip install --user mkdocs mkdocs-material To serve the documentation during the development use: cd docs mkdocs serve","title":"Building documentation"},{"location":"build_doc/#publish-to-github-pages","text":"To build and public the documentation directly to GitHub pages: cd docs mkdocs gh-deploy","title":"Publish to GitHub pages"},{"location":"build_rpm/","text":"Building RPM Move to the root directory of cloned repository and use standard make-rpms NethServer tool: ./prep-sources make-rpms Install RPM Copy the rpm to the NethServer Access the NethServer, then download COPR repository: wget https://copr.fedorainfracloud.org/coprs/g/cockpit/cockpit-preview/repo/epel-7/group_cockpit-cockpit-preview-epel-7.repo -O /etc/yum.repos.d/cockpit.repo yum install nethserver-cockpit*rpm","title":"Building RPM"},{"location":"build_rpm/#building-rpm","text":"Move to the root directory of cloned repository and use standard make-rpms NethServer tool: ./prep-sources make-rpms","title":"Building RPM"},{"location":"build_rpm/#install-rpm","text":"Copy the rpm to the NethServer Access the NethServer, then download COPR repository: wget https://copr.fedorainfracloud.org/coprs/g/cockpit/cockpit-preview/repo/epel-7/group_cockpit-cockpit-preview-epel-7.repo -O /etc/yum.repos.d/cockpit.repo yum install nethserver-cockpit*rpm","title":"Install RPM"},{"location":"environment/","text":"Development environment Index Install requirements Code style Build API and UI Sync API and UI The development environment can be prepared on a Fedora or CentOS 7 machine. Follow these steps: prepare the environment do your modification to API or UI sync your modification to the server where cockpit is running Install requirements Prepare the development environment: Install developer tools: npm and git On Fedora: dnf install npm git On CentOS: yum install npm git Clone the repository: git clone git@github.com:NethServer/nethserver-cockpit Enter inside the cloned repository and install all ui dependencies: ``` cd nethserver-cockpit/ui npm install npm run dev ``` Build UI Enter UI directory and build using npm : cd ui/ ./prep-sources Sync API and UI Files can be copied using rsync. While UI could be synced without executing the build task each time, make sure API is always built before sync. Use the following commands: ssh root @192.168.1.20 mkdir -p ~/.local/share/cockpit/nethserver cd api / rsync - avz -- delete . /* root@192.168.1.20:/usr/libexec/nethserver/api/ cd ui/ rsync -avz --delete dist/* root@192.168.1.20:/usr/share/cockpit/nethserver/ Code style Please use configuration from EditorConfig: http://editorconfig.org","title":"Development environment"},{"location":"environment/#development-environment","text":"Index Install requirements Code style Build API and UI Sync API and UI The development environment can be prepared on a Fedora or CentOS 7 machine. Follow these steps: prepare the environment do your modification to API or UI sync your modification to the server where cockpit is running","title":"Development environment"},{"location":"environment/#install-requirements","text":"Prepare the development environment: Install developer tools: npm and git On Fedora: dnf install npm git On CentOS: yum install npm git Clone the repository: git clone git@github.com:NethServer/nethserver-cockpit Enter inside the cloned repository and install all ui dependencies: ``` cd nethserver-cockpit/ui npm install npm run dev ```","title":"Install requirements"},{"location":"environment/#build-ui","text":"Enter UI directory and build using npm : cd ui/ ./prep-sources","title":"Build UI"},{"location":"environment/#sync-api-and-ui","text":"Files can be copied using rsync. While UI could be synced without executing the build task each time, make sure API is always built before sync. Use the following commands: ssh root @192.168.1.20 mkdir -p ~/.local/share/cockpit/nethserver cd api / rsync - avz -- delete . /* root@192.168.1.20:/usr/libexec/nethserver/api/ cd ui/ rsync -avz --delete dist/* root@192.168.1.20:/usr/share/cockpit/nethserver/","title":"Sync API and UI"},{"location":"environment/#code-style","text":"Please use configuration from EditorConfig: http://editorconfig.org","title":"Code style"},{"location":"new_module/","text":"How to write a new module A NethServer Cockpit module is composed by 4 parts: UI: a mix of HTML and CSS which presents data loaded using JavaScript (Cockpit API or NethServer API) API: a list of helpers to do actions: read - validate - update Package files: manifest and RPM spec file to create an installable package Translation files (optional) Install required tools Let's assume you've already prepared your own development environment . git clone git@github.com:NethServer/nethserver-cockpit-empty.git your-own-module cd your-own-module . \u251c\u2500\u2500 api \u2502 \u251c\u2500\u2500 read \u2502 \u251c\u2500\u2500 update \u2502 \u2514\u2500\u2500 validate \u251c\u2500\u2500 COPYING \u251c\u2500\u2500 createlinks \u251c\u2500\u2500 nethserver-cockpit-empty.json \u251c\u2500\u2500 nethserver-cockpit-empty.spec \u251c\u2500\u2500 prep-sources \u251c\u2500\u2500 README.md \u2514\u2500\u2500 ui \u251c\u2500\u2500 css \u2502 \u2514\u2500\u2500 style.css \u251c\u2500\u2500 dev \u2502 \u251c\u2500\u2500 cockpit.min.js \u2502 \u251c\u2500\u2500 jquery.min.js \u2502 \u2514\u2500\u2500 patternfly.css \u251c\u2500\u2500 i18n \u2502 \u251c\u2500\u2500 lang.js \u2502 \u2514\u2500\u2500 locale-en.json \u251c\u2500\u2500 index.html \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 app.js \u2502 \u2514\u2500\u2500 lib \u2502 \u251c\u2500\u2500 sammy.js \u2502 \u2514\u2500\u2500 sammy.template.js \u251c\u2500\u2500 logo.png \u251c\u2500\u2500 manifest.json \u251c\u2500\u2500 override.json \u2514\u2500\u2500 views \u251c\u2500\u2500 about.html \u251c\u2500\u2500 dashboard.html \u251c\u2500\u2500 item1.html \u2514\u2500\u2500 logs.html 8 directories, 26 files Build NethServer provides a set of tool for building RPMs under CentOS or Fedora. Prepare the build environment , then create the RPM for your module: Change occurencies Sobsitute all nethserver-cockpit-empty and NethServer Cockpit Empty occurencies with your-own-module and Your Own Module , to check all occurencies: grep -Rn nethserver-cockpit-empty * grep -Rn NethServer Cockpit Empty * Rename also nethserver-cockpit-empty-json and nethserver-cockpit-empty-spec with your-own-module.json and your-own-module.spec . Build the module: ./prep-sources make-rpms your-own-module.spec Then you have rpm builded inside the directory, install it, inside NethServer machine with scp your - own - module - x . y . z - t . ns7 . noarch . rpm root @192.168.1.20 : ssh root @192.168.1.20 yum install your - own - module - x . y . z - t . ns7 . noarch . rpm You can see the module in action by accessing Cockpit: https:// your_server :9090 , in the Applications section. If some JavaScript or HTML part doesn't load correctly, execute: systemctl restart cockpit Customize Edit all application metadata inside the manifest: your-own-module.json It's now time to start implementing some nice feature, you just need to know HTML, CSS and some JavaScript basics: there is no need to learn a new framework, use whatever you like. The source code must be placed inside the app directory: index.html : main HTML template, contains the navbar left menu with 3 base sections: Dashboard Item 1 (can be customizable) Logs About css/style.css : application stylesheet, customize your custom CSS but always follow UI guidelines js/app.js : JavaScript logic goes here. If you need to develop complex API, take a loot to API guidelines views/*.html : contains views for each routes defined in app.js You can ignore manifest.json and override.json files which are used for Cockpit internals (change only name inside with your-own-module ). The module UI will be installed inside /usr/share/cockpit/ project directory. The module API will be installed inside /usr/libexec/nethserver/api/ project directory. Metadata will be copied inside /usr/share/nethserver/applications directory. A new application card named as your project will be added to the Applications page. JavaScript frameworks The module provides a very small and easy routing system and javascipt API but in case you really want to pick a JavaScript framework, just include it inside index.html . AngularJS (https://angularjs.org/): html ng-app ... script src= https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js /script Vue (https://vuejs.org/): script src= https://unpkg.com/vue /script React (https://reactjs.org/): script crossorigin src = https://unpkg.com/react@16/umd/react.production.min.js / script script crossorigin src = https://unpkg.com/react-dom@16/umd/react-dom.production.min.js / script Save your work The code should always be kept under a version control system for tracking changes. NethServer build system assumes you're using git , so commit everything on a git repository: git init git add * git commit -a -m First import Always consider to share your code, take a look at GitHub .","title":"How to write a new module"},{"location":"new_module/#how-to-write-a-new-module","text":"A NethServer Cockpit module is composed by 4 parts: UI: a mix of HTML and CSS which presents data loaded using JavaScript (Cockpit API or NethServer API) API: a list of helpers to do actions: read - validate - update Package files: manifest and RPM spec file to create an installable package Translation files (optional)","title":"How to write a new module"},{"location":"new_module/#install-required-tools","text":"Let's assume you've already prepared your own development environment . git clone git@github.com:NethServer/nethserver-cockpit-empty.git your-own-module cd your-own-module . \u251c\u2500\u2500 api \u2502 \u251c\u2500\u2500 read \u2502 \u251c\u2500\u2500 update \u2502 \u2514\u2500\u2500 validate \u251c\u2500\u2500 COPYING \u251c\u2500\u2500 createlinks \u251c\u2500\u2500 nethserver-cockpit-empty.json \u251c\u2500\u2500 nethserver-cockpit-empty.spec \u251c\u2500\u2500 prep-sources \u251c\u2500\u2500 README.md \u2514\u2500\u2500 ui \u251c\u2500\u2500 css \u2502 \u2514\u2500\u2500 style.css \u251c\u2500\u2500 dev \u2502 \u251c\u2500\u2500 cockpit.min.js \u2502 \u251c\u2500\u2500 jquery.min.js \u2502 \u2514\u2500\u2500 patternfly.css \u251c\u2500\u2500 i18n \u2502 \u251c\u2500\u2500 lang.js \u2502 \u2514\u2500\u2500 locale-en.json \u251c\u2500\u2500 index.html \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 app.js \u2502 \u2514\u2500\u2500 lib \u2502 \u251c\u2500\u2500 sammy.js \u2502 \u2514\u2500\u2500 sammy.template.js \u251c\u2500\u2500 logo.png \u251c\u2500\u2500 manifest.json \u251c\u2500\u2500 override.json \u2514\u2500\u2500 views \u251c\u2500\u2500 about.html \u251c\u2500\u2500 dashboard.html \u251c\u2500\u2500 item1.html \u2514\u2500\u2500 logs.html 8 directories, 26 files","title":"Install required tools"},{"location":"new_module/#build","text":"NethServer provides a set of tool for building RPMs under CentOS or Fedora. Prepare the build environment , then create the RPM for your module:","title":"Build"},{"location":"new_module/#change-occurencies","text":"Sobsitute all nethserver-cockpit-empty and NethServer Cockpit Empty occurencies with your-own-module and Your Own Module , to check all occurencies: grep -Rn nethserver-cockpit-empty * grep -Rn NethServer Cockpit Empty * Rename also nethserver-cockpit-empty-json and nethserver-cockpit-empty-spec with your-own-module.json and your-own-module.spec .","title":"Change occurencies"},{"location":"new_module/#build-the-module","text":"./prep-sources make-rpms your-own-module.spec Then you have rpm builded inside the directory, install it, inside NethServer machine with scp your - own - module - x . y . z - t . ns7 . noarch . rpm root @192.168.1.20 : ssh root @192.168.1.20 yum install your - own - module - x . y . z - t . ns7 . noarch . rpm You can see the module in action by accessing Cockpit: https:// your_server :9090 , in the Applications section. If some JavaScript or HTML part doesn't load correctly, execute: systemctl restart cockpit","title":"Build the module:"},{"location":"new_module/#customize","text":"Edit all application metadata inside the manifest: your-own-module.json It's now time to start implementing some nice feature, you just need to know HTML, CSS and some JavaScript basics: there is no need to learn a new framework, use whatever you like. The source code must be placed inside the app directory: index.html : main HTML template, contains the navbar left menu with 3 base sections: Dashboard Item 1 (can be customizable) Logs About css/style.css : application stylesheet, customize your custom CSS but always follow UI guidelines js/app.js : JavaScript logic goes here. If you need to develop complex API, take a loot to API guidelines views/*.html : contains views for each routes defined in app.js You can ignore manifest.json and override.json files which are used for Cockpit internals (change only name inside with your-own-module ). The module UI will be installed inside /usr/share/cockpit/ project directory. The module API will be installed inside /usr/libexec/nethserver/api/ project directory. Metadata will be copied inside /usr/share/nethserver/applications directory. A new application card named as your project will be added to the Applications page.","title":"Customize"},{"location":"new_module/#javascript-frameworks","text":"The module provides a very small and easy routing system and javascipt API but in case you really want to pick a JavaScript framework, just include it inside index.html . AngularJS (https://angularjs.org/): html ng-app ... script src= https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js /script Vue (https://vuejs.org/): script src= https://unpkg.com/vue /script React (https://reactjs.org/): script crossorigin src = https://unpkg.com/react@16/umd/react.production.min.js / script script crossorigin src = https://unpkg.com/react-dom@16/umd/react-dom.production.min.js / script","title":"JavaScript frameworks"},{"location":"new_module/#save-your-work","text":"The code should always be kept under a version control system for tracking changes. NethServer build system assumes you're using git , so commit everything on a git repository: git init git add * git commit -a -m First import Always consider to share your code, take a look at GitHub .","title":"Save your work"},{"location":"ui_guidelines/","text":"UI guidelines Index UI design Left menu Applications Forms Notifications Accessibility UI design The whole web UI is designed following PatternFly patterns. Please, read carefully PatternFly documentation before starting the design of a new web page. The main goal is to have a consistent design and behavior across all modules. All web page should guide the user to well-defined and specific task like: bad task example: \"The user must choose the correct account provider\" good task example: \"The user must choose Active Directory provider if ACLs on shared folders are a functional requirements\" Left menu The left menu should be considered fixed: modules shouldn't add items inside the left menu. When a module needs to add a new feature, the web page should be added inside exiting sections like \"System\". Applications The Applications page is a container of each new module which implements new features, like mail server, nextcloud, etc. Each new application web page should display: the status of the application status on the top a list of common actions just below the status all configuration parameters (forms, table, etc.) in the center On first run, the application must display a modal wizard if the module can't be configured with a reasonable defaults. Also the web page should display suggestions to help the user to follow best practices. For example, inside the \"Certificate page\", the interface should display a suggestion to enable Let's Encrypt if a self-signed certificate is used as default. Each application must be described by a JSON manifest inspired to AppData freedesktop.org format. Forms A configuration form should always display the minimum number of fields needed to configure the feature. Extra parameters should be hidden inside an Advanced panel with reasonable defaults. For example, when creating a user you need at least the user name, the full name and the password; but you could hide extra details like street address or phone number. Also it is a good practice to add a \"Description\" when creating records inside tables. Notifications NethServer Cockpit provides multiple toast notification . Each notification can have one of these states: success : everything is ok. Transient: it stays on the screen for 3 seconds. error : something went wrong. Not transient: it stays on the screen until the user explicitly close it. May require an action link. Finally there also is a task notification, it stays on the screen until the task has been completed. This kind of notification can be created only by signal-event . Example // success - hide notifications after 3 seconds parent . ns . $children [ 0 ]. notifications . success . show = true ; parent . ns . $children [ 0 ]. notifications . success . message = Your success message ; setTimeout ( function () { parent . ns . $children [ 0 ]. notifications . success . show = false ; }, 3000 ); // error parent . ns . $children [ 0 ]. notifications . error . show = true ; parent . ns . $children [ 0 ]. notifications . error . message = Your error message ; // event parent . ns . $children [ 0 ]. notifications . event . show = true ; parent . ns . $children [ 0 ]. notifications . event . name = Your event name ; parent . ns . $children [ 0 ]. notifications . event . message = Your action-name ; parent . ns . $children [ 0 ]. notifications . event . progress = 50 ; /* */ Call API Using Cockpit API you can easily call NethServer API or your own module API in this way: // Definition parent . ns . exec ( [ api-name / action ], // action can be: read | validate | update null , // used for input in JSON format - { key : value } null , // used for strem output, for actions the print on STDOUT function ( success ) { success = JSON . parse ( success ); return success ; }, function ( error ) { return error ; } ); // Example // define method function validate ( obj , callback ) { parent . ns . exec ( [ your-own-module/validate ], obj , null , function ( success ) { var success = JSON . parse ( success ); callback ( success ); }, function ( error , data ) { var errorData = JSON . parse ( data ); callback ( errorData ); } ); } // call it var validateObj = {} validate ( validateObj , function ( result ) { // check errors // if(result) { ... } // if no errors // update value // ... }); Modals Modal overlay should be provided any time the user needs to enter data on a form and press \"Save\" button to change system configuration. See also Modal Overlay for extra use cases. Accessibility We need to evaluate how PatternFly copes with people suffering of low vision, who need to access most features using the keyboard shortcuts.","title":"UI guidelines"},{"location":"ui_guidelines/#ui-guidelines","text":"Index UI design Left menu Applications Forms Notifications Accessibility","title":"UI guidelines"},{"location":"ui_guidelines/#ui-design","text":"The whole web UI is designed following PatternFly patterns. Please, read carefully PatternFly documentation before starting the design of a new web page. The main goal is to have a consistent design and behavior across all modules. All web page should guide the user to well-defined and specific task like: bad task example: \"The user must choose the correct account provider\" good task example: \"The user must choose Active Directory provider if ACLs on shared folders are a functional requirements\"","title":"UI design"},{"location":"ui_guidelines/#left-menu","text":"The left menu should be considered fixed: modules shouldn't add items inside the left menu. When a module needs to add a new feature, the web page should be added inside exiting sections like \"System\".","title":"Left menu"},{"location":"ui_guidelines/#applications","text":"The Applications page is a container of each new module which implements new features, like mail server, nextcloud, etc. Each new application web page should display: the status of the application status on the top a list of common actions just below the status all configuration parameters (forms, table, etc.) in the center On first run, the application must display a modal wizard if the module can't be configured with a reasonable defaults. Also the web page should display suggestions to help the user to follow best practices. For example, inside the \"Certificate page\", the interface should display a suggestion to enable Let's Encrypt if a self-signed certificate is used as default. Each application must be described by a JSON manifest inspired to AppData freedesktop.org format.","title":"Applications"},{"location":"ui_guidelines/#forms","text":"A configuration form should always display the minimum number of fields needed to configure the feature. Extra parameters should be hidden inside an Advanced panel with reasonable defaults. For example, when creating a user you need at least the user name, the full name and the password; but you could hide extra details like street address or phone number. Also it is a good practice to add a \"Description\" when creating records inside tables.","title":"Forms"},{"location":"ui_guidelines/#notifications","text":"NethServer Cockpit provides multiple toast notification . Each notification can have one of these states: success : everything is ok. Transient: it stays on the screen for 3 seconds. error : something went wrong. Not transient: it stays on the screen until the user explicitly close it. May require an action link. Finally there also is a task notification, it stays on the screen until the task has been completed. This kind of notification can be created only by signal-event .","title":"Notifications"},{"location":"ui_guidelines/#example","text":"// success - hide notifications after 3 seconds parent . ns . $children [ 0 ]. notifications . success . show = true ; parent . ns . $children [ 0 ]. notifications . success . message = Your success message ; setTimeout ( function () { parent . ns . $children [ 0 ]. notifications . success . show = false ; }, 3000 ); // error parent . ns . $children [ 0 ]. notifications . error . show = true ; parent . ns . $children [ 0 ]. notifications . error . message = Your error message ; // event parent . ns . $children [ 0 ]. notifications . event . show = true ; parent . ns . $children [ 0 ]. notifications . event . name = Your event name ; parent . ns . $children [ 0 ]. notifications . event . message = Your action-name ; parent . ns . $children [ 0 ]. notifications . event . progress = 50 ; /* */","title":"Example"},{"location":"ui_guidelines/#call-api","text":"Using Cockpit API you can easily call NethServer API or your own module API in this way: // Definition parent . ns . exec ( [ api-name / action ], // action can be: read | validate | update null , // used for input in JSON format - { key : value } null , // used for strem output, for actions the print on STDOUT function ( success ) { success = JSON . parse ( success ); return success ; }, function ( error ) { return error ; } ); // Example // define method function validate ( obj , callback ) { parent . ns . exec ( [ your-own-module/validate ], obj , null , function ( success ) { var success = JSON . parse ( success ); callback ( success ); }, function ( error , data ) { var errorData = JSON . parse ( data ); callback ( errorData ); } ); } // call it var validateObj = {} validate ( validateObj , function ( result ) { // check errors // if(result) { ... } // if no errors // update value // ... });","title":"Call API"},{"location":"ui_guidelines/#modals","text":"Modal overlay should be provided any time the user needs to enter data on a form and press \"Save\" button to change system configuration. See also Modal Overlay for extra use cases.","title":"Modals"},{"location":"ui_guidelines/#accessibility","text":"We need to evaluate how PatternFly copes with people suffering of low vision, who need to access most features using the keyboard shortcuts.","title":"Accessibility"},{"location":"api/system-aliases/","text":"system-alias Read and write system DNS system alias. read List current configured aliases. Output The configuration contains an array of alias records (type self from hosts db). Output example: { status : , configuration : [ { props : { Description : }, name : alias1.neth.loc , type : self } ] } validate Validate a collection of alias records. Constraints the alias name must be a valid FQDN Input Use the read output as input. Each record must have the type set to self , the Description field is currently not used. Example: { configuration : [ { props : { Description : }, name : test3.nethserver.org , type : self }, { props : { Description : }, name : test2.nethserver.org , type : self } ] } Invocation example: echo { configuration : [{ props :{ Description : }, name : test3.nethserver.org , type : self }, { props :{ Description : }, name : test2.nethserver.org , type : self }]} | ./validate update All alias are destroyed and recreated on update. The helper should be invoked once, after all alias has been modified. Input The same from validate helper. Invocation example: echo { configuration : [{ props :{ Description : }, name : test3.neth.eu , type : self }, { props :{ Description : }, name : test2.neth.eu , type : self }]} | ./update","title":"system-alias"},{"location":"api/system-aliases/#system-alias","text":"Read and write system DNS system alias.","title":"system-alias"},{"location":"api/system-aliases/#read","text":"List current configured aliases.","title":"read"},{"location":"api/system-aliases/#output","text":"The configuration contains an array of alias records (type self from hosts db). Output example: { status : , configuration : [ { props : { Description : }, name : alias1.neth.loc , type : self } ] }","title":"Output"},{"location":"api/system-aliases/#validate","text":"Validate a collection of alias records.","title":"validate"},{"location":"api/system-aliases/#constraints","text":"the alias name must be a valid FQDN","title":"Constraints"},{"location":"api/system-aliases/#input","text":"Use the read output as input. Each record must have the type set to self , the Description field is currently not used. Example: { configuration : [ { props : { Description : }, name : test3.nethserver.org , type : self }, { props : { Description : }, name : test2.nethserver.org , type : self } ] } Invocation example: echo { configuration : [{ props :{ Description : }, name : test3.nethserver.org , type : self }, { props :{ Description : }, name : test2.nethserver.org , type : self }]} | ./validate","title":"Input"},{"location":"api/system-aliases/#update","text":"All alias are destroyed and recreated on update. The helper should be invoked once, after all alias has been modified.","title":"update"},{"location":"api/system-aliases/#input_1","text":"The same from validate helper. Invocation example: echo { configuration : [{ props :{ Description : }, name : test3.neth.eu , type : self }, { props :{ Description : }, name : test2.neth.eu , type : self }]} | ./update","title":"Input"},{"location":"api/system-apps/","text":"system-apps Return installed NethServer apps (or modules). The response is composed by: Name Id (rpm package name) Description, Author, Summary, License, Tags, Bugs URL Repository reference Version Icon read List all available applications. Input If no input has been provided, the helper will return the list of all available applications. To retrieve a application, pass the name parameter to the read helper. Example: echo { name : nethserver-cockpit-empty } | ./read Output Example: [ { description : Very very very very very long description of NethServer Cockpit Empty , license : GPL-3.0 , tags : [ tag1 , tag2 , tag3 ], url : nethserver-cockpit-empty , author : { url : https://github.com/NethServer/nethserver-cockpit-empty , name : Author s name of NethServer Cockpit Empty , email : Author s email of NethServer Cockpit Empty }, bugs : { url : https://github.com/NethServer/dev/issues }, summary : Short description of NethServer Cockpit Empty , provides : [ nethserver-cockpit-empty ], release : { version : 1.0.0 }, icon : icon.png , homepage : https://github.com/NethServer/nethserver-cockpit-empty , id : nethserver-cockpit-empty , name : NethServer Cockpit Empty }, ... ]","title":"system-apps"},{"location":"api/system-apps/#system-apps","text":"Return installed NethServer apps (or modules). The response is composed by: Name Id (rpm package name) Description, Author, Summary, License, Tags, Bugs URL Repository reference Version Icon","title":"system-apps"},{"location":"api/system-apps/#read","text":"List all available applications.","title":"read"},{"location":"api/system-apps/#input","text":"If no input has been provided, the helper will return the list of all available applications. To retrieve a application, pass the name parameter to the read helper. Example: echo { name : nethserver-cockpit-empty } | ./read","title":"Input"},{"location":"api/system-apps/#output","text":"Example: [ { description : Very very very very very long description of NethServer Cockpit Empty , license : GPL-3.0 , tags : [ tag1 , tag2 , tag3 ], url : nethserver-cockpit-empty , author : { url : https://github.com/NethServer/nethserver-cockpit-empty , name : Author s name of NethServer Cockpit Empty , email : Author s email of NethServer Cockpit Empty }, bugs : { url : https://github.com/NethServer/dev/issues }, summary : Short description of NethServer Cockpit Empty , provides : [ nethserver-cockpit-empty ], release : { version : 1.0.0 }, icon : icon.png , homepage : https://github.com/NethServer/nethserver-cockpit-empty , id : nethserver-cockpit-empty , name : NethServer Cockpit Empty }, ... ]","title":"Output"},{"location":"api/system-certificate/","text":"system-certificate Manage system certificates. Supported operations: list certificates show certificate content configure Let's Encrypt configure self-signed certificate set default certificate read List all available certificates. Input If no input has been provided, the helper will return the list of all available certificates. To retrieve a certificate, pass the name parameter to the read helper. Example: echo { name : /etc/pki/tls/certs/NSRV.crt } | ./read Output List Internally, the helper calls /usr/libexec/nethserver/cert-list . Output current pki configuration and the list of existing certificates. If some pki properties are empty, system defaults will be used to fill the returned object. Example: { status : , configuration : { pki : { props : { LetsEncryptMail : , SubjectAltName : , KeyFile : , CrtFile : , State : , EmailAddress : , ChainFile : , Organization : , CertificateDuration : 3650 , Locality : , LetsEncryptDomains : , CommonName : , LetsEncryptRenewDays : 30 , LetsEncrypt : disabled , CountryCode : , OrganizationalUnitName : }, name : pki , type : configuration }, certificates : [ { cn : NethServer, O=Example Org, ST=SomeState, OU=Main , file : /etc/pki/tls/certs/NSRV.crt , issuer : NethServer, O=Example Org, ST=SomeState, OU=Main , default : 1 , key : /etc/pki/tls/private/NSRV.key , chain : , expiration_t : 1795129200 , expired : 0 } ] } } Certificate content Internally, the helper calls /usr/libexec/nethserver/pki-info . Output is base64 encoded: { certificate : Q2Vyd .... } validate Constraints Validate 3 different actions: lets-encrypt upload self-signed The action must be specified inside the JSON action field. Example: { action : upload , ... } Constraints for self-signed : CountryCode: empty or 2 letters State, Locality, Organization, OrganizationalUnitName, CommonName: valid x509 fields EmailAddress: empty or valid mail address SubjectAltName: comma-separated list of FQDNs Constraints for lets-encrypt : LetsEncryptMail: empty or valid mail address LetsEncryptDomains: comma-separated list of FQDNs LetsEncryptRenewDays: and integer greater than 10 and lower than 90 Check all Let's Encrypt conditions are met Constraints for upload : certificate: valid x509 certificate chain: valid x509 certificate key: valid key for running tlspolicy Input self-signed action must be set to self-signed pki record in json format Example: { props : { SubjectAltName : t1.test.net,t2.test.net , State : myState , EmailAddress : , Organization : My company , CertificateDuration : 3650 , Locality : , CommonName : , CountryCode : it , OrganizationalUnitName : }, action : self-signed } Invocation example: echo { props :{ SubjectAltName : t1.test.net,t2.test.net , State : myState , EmailAddress : , Organization : My company , CertificateDuration : 3650 , Locality : , CommonName : , CountryCode : it , OrganizationalUnitName : myoffice }, action : self-signed } | ./update lets-encrypt Manfatory fields: action must be set to lets-encrypt LetsEncryptMail LetsEncryptDomains LetsEncryptRenewDays Example: { props : { LetsEncryptMail : , LetsEncryptDomains : test.local.net , LetsEncryptRenewDays : 30 , }, action : lets-encrypt } Warning: the UI shouldn't change the LetsEncrypt field. upload Format: action must be set to upload name is mandatory and set the name for the uploaded certs certificate , key and chain must contain base64 encoded data the chain field can be empty { action : upload , files : { name : mycert , certificate : ... , key : ... , chain : ... } } update Available actions: self-signed lets-encrypt upload set-default self-signed Same input from validate. lets-encrypt Same input from validate. upload Same input from validate. set-default Mandatory fields: CrtFile , KeyFile and ChainFile . The ChainFile field can be empty. Input example: { action : set-default , props : { KeyFile : /etc/pki/tls/private/NSRV.key , CrtFile : /etc/pki/tls/certs/NSRV.crt , ChainFile : } }","title":"system-certificate"},{"location":"api/system-certificate/#system-certificate","text":"Manage system certificates. Supported operations: list certificates show certificate content configure Let's Encrypt configure self-signed certificate set default certificate","title":"system-certificate"},{"location":"api/system-certificate/#read","text":"List all available certificates.","title":"read"},{"location":"api/system-certificate/#input","text":"If no input has been provided, the helper will return the list of all available certificates. To retrieve a certificate, pass the name parameter to the read helper. Example: echo { name : /etc/pki/tls/certs/NSRV.crt } | ./read","title":"Input"},{"location":"api/system-certificate/#output","text":"","title":"Output"},{"location":"api/system-certificate/#list","text":"Internally, the helper calls /usr/libexec/nethserver/cert-list . Output current pki configuration and the list of existing certificates. If some pki properties are empty, system defaults will be used to fill the returned object. Example: { status : , configuration : { pki : { props : { LetsEncryptMail : , SubjectAltName : , KeyFile : , CrtFile : , State : , EmailAddress : , ChainFile : , Organization : , CertificateDuration : 3650 , Locality : , LetsEncryptDomains : , CommonName : , LetsEncryptRenewDays : 30 , LetsEncrypt : disabled , CountryCode : , OrganizationalUnitName : }, name : pki , type : configuration }, certificates : [ { cn : NethServer, O=Example Org, ST=SomeState, OU=Main , file : /etc/pki/tls/certs/NSRV.crt , issuer : NethServer, O=Example Org, ST=SomeState, OU=Main , default : 1 , key : /etc/pki/tls/private/NSRV.key , chain : , expiration_t : 1795129200 , expired : 0 } ] } }","title":"List"},{"location":"api/system-certificate/#certificate-content","text":"Internally, the helper calls /usr/libexec/nethserver/pki-info . Output is base64 encoded: { certificate : Q2Vyd .... }","title":"Certificate content"},{"location":"api/system-certificate/#validate","text":"","title":"validate"},{"location":"api/system-certificate/#constraints","text":"Validate 3 different actions: lets-encrypt upload self-signed The action must be specified inside the JSON action field. Example: { action : upload , ... } Constraints for self-signed : CountryCode: empty or 2 letters State, Locality, Organization, OrganizationalUnitName, CommonName: valid x509 fields EmailAddress: empty or valid mail address SubjectAltName: comma-separated list of FQDNs Constraints for lets-encrypt : LetsEncryptMail: empty or valid mail address LetsEncryptDomains: comma-separated list of FQDNs LetsEncryptRenewDays: and integer greater than 10 and lower than 90 Check all Let's Encrypt conditions are met Constraints for upload : certificate: valid x509 certificate chain: valid x509 certificate key: valid key for running tlspolicy","title":"Constraints"},{"location":"api/system-certificate/#input_1","text":"","title":"Input"},{"location":"api/system-certificate/#self-signed","text":"action must be set to self-signed pki record in json format Example: { props : { SubjectAltName : t1.test.net,t2.test.net , State : myState , EmailAddress : , Organization : My company , CertificateDuration : 3650 , Locality : , CommonName : , CountryCode : it , OrganizationalUnitName : }, action : self-signed } Invocation example: echo { props :{ SubjectAltName : t1.test.net,t2.test.net , State : myState , EmailAddress : , Organization : My company , CertificateDuration : 3650 , Locality : , CommonName : , CountryCode : it , OrganizationalUnitName : myoffice }, action : self-signed } | ./update","title":"self-signed"},{"location":"api/system-certificate/#lets-encrypt","text":"Manfatory fields: action must be set to lets-encrypt LetsEncryptMail LetsEncryptDomains LetsEncryptRenewDays Example: { props : { LetsEncryptMail : , LetsEncryptDomains : test.local.net , LetsEncryptRenewDays : 30 , }, action : lets-encrypt } Warning: the UI shouldn't change the LetsEncrypt field.","title":"lets-encrypt"},{"location":"api/system-certificate/#upload","text":"Format: action must be set to upload name is mandatory and set the name for the uploaded certs certificate , key and chain must contain base64 encoded data the chain field can be empty { action : upload , files : { name : mycert , certificate : ... , key : ... , chain : ... } }","title":"upload"},{"location":"api/system-certificate/#update","text":"Available actions: self-signed lets-encrypt upload set-default","title":"update"},{"location":"api/system-certificate/#self-signed_1","text":"Same input from validate.","title":"self-signed"},{"location":"api/system-certificate/#lets-encrypt_1","text":"Same input from validate.","title":"lets-encrypt"},{"location":"api/system-certificate/#upload_1","text":"Same input from validate.","title":"upload"},{"location":"api/system-certificate/#set-default","text":"Mandatory fields: CrtFile , KeyFile and ChainFile . The ChainFile field can be empty. Input example: { action : set-default , props : { KeyFile : /etc/pki/tls/private/NSRV.key , CrtFile : /etc/pki/tls/certs/NSRV.crt , ChainFile : } }","title":"set-default"},{"location":"api/system-company/","text":"system-company Read ans set OrganizationContact record from configuration db. read Output The configuration key contains the OrganizationContact record. Output example: { status : , configuration : { props : { Department : Main , Street : 123 Main Street , PhoneNumber : 575-1685 , City : Hometown , State : , CountryCode : , Company : Example Org }, name : OrganizationContact , type : configuration } } validate Constraints Company must not empty Input Input: an esmith db record in JSON format. Input example from: config getjson OrganizationContact : { props : { Department : Main , Street : 123 Main Street , PhoneNumber : 575-1685 , City : Hometown , State : , CountryCode : , Company : Example Org }, name : OrganizationContact , type : configuration } write Same input from validate helper.","title":"system-company"},{"location":"api/system-company/#system-company","text":"Read ans set OrganizationContact record from configuration db.","title":"system-company"},{"location":"api/system-company/#read","text":"","title":"read"},{"location":"api/system-company/#output","text":"The configuration key contains the OrganizationContact record. Output example: { status : , configuration : { props : { Department : Main , Street : 123 Main Street , PhoneNumber : 575-1685 , City : Hometown , State : , CountryCode : , Company : Example Org }, name : OrganizationContact , type : configuration } }","title":"Output"},{"location":"api/system-company/#validate","text":"","title":"validate"},{"location":"api/system-company/#constraints","text":"Company must not empty","title":"Constraints"},{"location":"api/system-company/#input","text":"Input: an esmith db record in JSON format. Input example from: config getjson OrganizationContact : { props : { Department : Main , Street : 123 Main Street , PhoneNumber : 575-1685 , City : Hometown , State : , CountryCode : , Company : Example Org }, name : OrganizationContact , type : configuration }","title":"Input"},{"location":"api/system-company/#write","text":"Same input from validate helper.","title":"write"},{"location":"api/system-dns/","text":"system-dns Read and set upstream DNS servers for DNSMasq. read Input Return the value of NameServers record from configuration db. The record is inside the the configuration field: { status : , configuration : { props : { NameServers : 8.8.8.8 }, name : dns , type : configuration } } validate Constraints NameServers must be a comma-separated list of valid IPv4 addresses Input The NameServers record from `configuration esmith db record in JSON format. The NameServers property is a comma-separated list of IP address. It must contain at least one element. Example: { props : { NameServers : 8.8.8.8 }, name : dns , type : configuration } Validation example: echo { props :{ NameServers : 8.8.8.8 }, name : dns , type : configuration } | ./validate write Same input from validate helper.","title":"system-dns"},{"location":"api/system-dns/#system-dns","text":"Read and set upstream DNS servers for DNSMasq.","title":"system-dns"},{"location":"api/system-dns/#read","text":"","title":"read"},{"location":"api/system-dns/#input","text":"Return the value of NameServers record from configuration db. The record is inside the the configuration field: { status : , configuration : { props : { NameServers : 8.8.8.8 }, name : dns , type : configuration } }","title":"Input"},{"location":"api/system-dns/#validate","text":"","title":"validate"},{"location":"api/system-dns/#constraints","text":"NameServers must be a comma-separated list of valid IPv4 addresses","title":"Constraints"},{"location":"api/system-dns/#input_1","text":"The NameServers record from `configuration esmith db record in JSON format. The NameServers property is a comma-separated list of IP address. It must contain at least one element. Example: { props : { NameServers : 8.8.8.8 }, name : dns , type : configuration } Validation example: echo { props :{ NameServers : 8.8.8.8 }, name : dns , type : configuration } | ./validate","title":"Input"},{"location":"api/system-dns/#write","text":"Same input from validate helper.","title":"write"},{"location":"api/system-hostname/","text":"system-hostname Read and the set the system hostname. read Return the system hostname. Output Example: { hostname : myserver.test.local } validate Constraints Must be at least a second-level domain Can't be localhost.localdomain Validate against myhostname system-validator Input Takes the same output from read: { hostname : myserver.test.local } Invocation example: echo { hostname : localhost.localdomain } | ./validate update Input Takes the same input from validate.","title":"system-hostname"},{"location":"api/system-hostname/#system-hostname","text":"Read and the set the system hostname.","title":"system-hostname"},{"location":"api/system-hostname/#read","text":"Return the system hostname.","title":"read"},{"location":"api/system-hostname/#output","text":"Example: { hostname : myserver.test.local }","title":"Output"},{"location":"api/system-hostname/#validate","text":"","title":"validate"},{"location":"api/system-hostname/#constraints","text":"Must be at least a second-level domain Can't be localhost.localdomain Validate against myhostname system-validator","title":"Constraints"},{"location":"api/system-hostname/#input","text":"Takes the same output from read: { hostname : myserver.test.local } Invocation example: echo { hostname : localhost.localdomain } | ./validate","title":"Input"},{"location":"api/system-hostname/#update","text":"","title":"update"},{"location":"api/system-hostname/#input_1","text":"Takes the same input from validate.","title":"Input"},{"location":"api/system-hosts/","text":"system-hosts Manage DNS records for DNSMasq. read Input Return all current configured records from the hosts file inside the status field. Return all remote records from hosts database inside the `configuration field. { status : { 127.0.0.1 : [ localhost , localhost.localdomain ], 192.168.1.2 : [ t1.net.loc ], 192.168.5.246 : [ test.local.neth.eu , test ] }, configuration : [ { props : { IpAddress : 192.168.1.2 , Description : , WildcardMode : disabled }, name : t1.net.loc , type : remote } ] } validate Constraints The key ( name field ) must be a valid FQDN and must not already exists in case of creation WildcardMode can be enabled or disabled IpAddress must be a valid IPv4 address Input A remote host esmith db record in JSON format. The record must also contain an action fields which can be: - create for new dns record creation - update when updating and existing record Example: { props : { IpAddress : 192.168.1.2 , Description : , WildcardMode : disabled }, name : t1.net.loc , type : remote , action : create } update Use the same input from validate. create Use the same input from validate. delete Pass the the key to be deleted inside the name field. Example: { name : my.host.com }","title":"system-hosts"},{"location":"api/system-hosts/#system-hosts","text":"Manage DNS records for DNSMasq.","title":"system-hosts"},{"location":"api/system-hosts/#read","text":"","title":"read"},{"location":"api/system-hosts/#input","text":"Return all current configured records from the hosts file inside the status field. Return all remote records from hosts database inside the `configuration field. { status : { 127.0.0.1 : [ localhost , localhost.localdomain ], 192.168.1.2 : [ t1.net.loc ], 192.168.5.246 : [ test.local.neth.eu , test ] }, configuration : [ { props : { IpAddress : 192.168.1.2 , Description : , WildcardMode : disabled }, name : t1.net.loc , type : remote } ] }","title":"Input"},{"location":"api/system-hosts/#validate","text":"","title":"validate"},{"location":"api/system-hosts/#constraints","text":"The key ( name field ) must be a valid FQDN and must not already exists in case of creation WildcardMode can be enabled or disabled IpAddress must be a valid IPv4 address","title":"Constraints"},{"location":"api/system-hosts/#input_1","text":"A remote host esmith db record in JSON format. The record must also contain an action fields which can be: - create for new dns record creation - update when updating and existing record Example: { props : { IpAddress : 192.168.1.2 , Description : , WildcardMode : disabled }, name : t1.net.loc , type : remote , action : create }","title":"Input"},{"location":"api/system-hosts/#update","text":"Use the same input from validate.","title":"update"},{"location":"api/system-hosts/#create","text":"Use the same input from validate.","title":"create"},{"location":"api/system-hosts/#delete","text":"Pass the the key to be deleted inside the name field. Example: { name : my.host.com }","title":"delete"},{"location":"api/system-openssh/","text":"system-openssh Read and write configuration for nethserver-openssh package. read Output A JSON object containing configuration and status fields: { configuration : { sshd prop }, status : { connections : list of active connections } } Output example: { configuration : { name : sshd , props : { LoginGraceTime : 2m , MaxAuthTries : 6 , PasswordAuthentication : yes , PermitRootLogin : yes , Protocol : 2 , TCPPort : 22 , UsePAM : yes , access : green,red , status : enabled }, type : service }, status : { connections : [ { local : 192.168.1.1:22 , peer : 192.168.1.45:54478 } ] } } validate Constraints PasswordAuthentication: boolean PermitRootLogin: boolean TCPPort: port number Input An Esmith db record in JSON format: { name : key , props : { prop : value ... prop : value }, type : record-type } Input example from: config getjson sshd : { name : sshd , props : { PasswordAuthentication : yes , PermitRootLogin : yes , TCPPort : 22 , }, type : service } Invocation example: echo { props :{ PasswordAuthentication : yes , PermitRootLogin : yes , TCPPort : 22 }, name : sshd , type : service } | ./validate update Same input from validate helper.","title":"system-openssh"},{"location":"api/system-openssh/#system-openssh","text":"Read and write configuration for nethserver-openssh package.","title":"system-openssh"},{"location":"api/system-openssh/#read","text":"","title":"read"},{"location":"api/system-openssh/#output","text":"A JSON object containing configuration and status fields: { configuration : { sshd prop }, status : { connections : list of active connections } } Output example: { configuration : { name : sshd , props : { LoginGraceTime : 2m , MaxAuthTries : 6 , PasswordAuthentication : yes , PermitRootLogin : yes , Protocol : 2 , TCPPort : 22 , UsePAM : yes , access : green,red , status : enabled }, type : service }, status : { connections : [ { local : 192.168.1.1:22 , peer : 192.168.1.45:54478 } ] } }","title":"Output"},{"location":"api/system-openssh/#validate","text":"","title":"validate"},{"location":"api/system-openssh/#constraints","text":"PasswordAuthentication: boolean PermitRootLogin: boolean TCPPort: port number","title":"Constraints"},{"location":"api/system-openssh/#input","text":"An Esmith db record in JSON format: { name : key , props : { prop : value ... prop : value }, type : record-type } Input example from: config getjson sshd : { name : sshd , props : { PasswordAuthentication : yes , PermitRootLogin : yes , TCPPort : 22 , }, type : service } Invocation example: echo { props :{ PasswordAuthentication : yes , PermitRootLogin : yes , TCPPort : 22 }, name : sshd , type : service } | ./validate","title":"Input"},{"location":"api/system-openssh/#update","text":"Same input from validate helper.","title":"update"},{"location":"api/system-services/","text":"system-services Get the status and control system services. read Output Current service status and preset is inside the status field. The configuration field contains all properties for each service. Example: { status : [ { status : 1 , name : chronyd , running : 1 }, { status : 1 , name : cockpit.socket , running : 1 }, ... ], configuration : [ { ports : { access : green , UDP : [ 123 ], TCP : [ 123 ] }, props : { NTPServer : pool.ntp.org }, name : chronyd , description : NTP client/server }, { ports : { access : green,red , UDP : [], TCP : [] }, props : {}, name : cockpit.socket , description : Cockpit Web Service Socket }, ... ] } update Execute actions on selected service. Available actions: stop: stop the service start: start the service restart: restart the service enable: enable and start the service disable: disable and start the service Input A JSON object with two fields: name: the service name action: the action to execute Example: { action : enable , name : httpd } Invocation example: echo { action : restart , name : httpd } | ./update","title":"system-services"},{"location":"api/system-services/#system-services","text":"Get the status and control system services.","title":"system-services"},{"location":"api/system-services/#read","text":"","title":"read"},{"location":"api/system-services/#output","text":"Current service status and preset is inside the status field. The configuration field contains all properties for each service. Example: { status : [ { status : 1 , name : chronyd , running : 1 }, { status : 1 , name : cockpit.socket , running : 1 }, ... ], configuration : [ { ports : { access : green , UDP : [ 123 ], TCP : [ 123 ] }, props : { NTPServer : pool.ntp.org }, name : chronyd , description : NTP client/server }, { ports : { access : green,red , UDP : [], TCP : [] }, props : {}, name : cockpit.socket , description : Cockpit Web Service Socket }, ... ] }","title":"Output"},{"location":"api/system-services/#update","text":"Execute actions on selected service. Available actions: stop: stop the service start: start the service restart: restart the service enable: enable and start the service disable: disable and start the service","title":"update"},{"location":"api/system-services/#input","text":"A JSON object with two fields: name: the service name action: the action to execute Example: { action : enable , name : httpd } Invocation example: echo { action : restart , name : httpd } | ./update","title":"Input"},{"location":"api/system-shutdown/","text":"system-shutdown Reboot or power off the server. update Input A JSON containing an action field. Valid actions are: poweroff and reboot . Example: { action : reboot }","title":"system-shutdown"},{"location":"api/system-shutdown/#system-shutdown","text":"Reboot or power off the server.","title":"system-shutdown"},{"location":"api/system-shutdown/#update","text":"","title":"update"},{"location":"api/system-shutdown/#input","text":"A JSON containing an action field. Valid actions are: poweroff and reboot . Example: { action : reboot }","title":"Input"},{"location":"api/system-status/","text":"system-status Return various information on the server. The system status is composed by: CPU number and type kernel version memory statistics (in kB) uptime OS release load hardware vendor and product name read Output Example: { configuration : , status : { cpu : { model : Intel(R) Core(TM) i5-3570 CPU @ 3.40GHz , n : 1 }, hardware : innotek GmbH VirtualBox , kernel : 3.10.0-693.21.1.el7.x86_64 , load : [ 0.18 , 0.06 , 0.06 ], memory : { Active : 364 , Active(anon) : 55 , Active(file) : 310 , AnonHugePages : 14 , AnonPages : 109 , Bounce : 0 , Buffers : 3 , Cached : 471 , CommitLimit : 1521 , Committed_AS : 574 , DirectMap2M : 938 , DirectMap4k : 86 , Dirty : 1 , HardwareCorrupted : 0 , HugePages_Free : 0 , HugePages_Rsvd : 0 , HugePages_Surp : 0 , HugePages_Total : 0 , Hugepagesize : 2 , Inactive : 218 , Inactive(anon) : 72 , Inactive(file) : 146 , KernelStack : 3 , Mapped : 39 , MemAvailable : 591 , MemFree : 170 , MemTotal : 993 , Mlocked : 0 , NFS_Unstable : 0 , PageTables : 18 , SReclaimable : 145 , SUnreclaim : 31 , Shmem : 18 , Slab : 176 , SwapCached : 1 , SwapFree : 1013 , SwapTotal : 1024 , Unevictable : 0 , VmallocChunk : 33554424 , VmallocTotal : 33554432 , VmallocUsed : 6 , Writeback : 0 , WritebackTmp : 0 }, release : NethServer release 7.5.1804 (final) , uptime : { days : 0 , hours : 1 , minutes : 34 , seconds : 42 } } }","title":"system-status"},{"location":"api/system-status/#system-status","text":"Return various information on the server. The system status is composed by: CPU number and type kernel version memory statistics (in kB) uptime OS release load hardware vendor and product name","title":"system-status"},{"location":"api/system-status/#read","text":"","title":"read"},{"location":"api/system-status/#output","text":"Example: { configuration : , status : { cpu : { model : Intel(R) Core(TM) i5-3570 CPU @ 3.40GHz , n : 1 }, hardware : innotek GmbH VirtualBox , kernel : 3.10.0-693.21.1.el7.x86_64 , load : [ 0.18 , 0.06 , 0.06 ], memory : { Active : 364 , Active(anon) : 55 , Active(file) : 310 , AnonHugePages : 14 , AnonPages : 109 , Bounce : 0 , Buffers : 3 , Cached : 471 , CommitLimit : 1521 , Committed_AS : 574 , DirectMap2M : 938 , DirectMap4k : 86 , Dirty : 1 , HardwareCorrupted : 0 , HugePages_Free : 0 , HugePages_Rsvd : 0 , HugePages_Surp : 0 , HugePages_Total : 0 , Hugepagesize : 2 , Inactive : 218 , Inactive(anon) : 72 , Inactive(file) : 146 , KernelStack : 3 , Mapped : 39 , MemAvailable : 591 , MemFree : 170 , MemTotal : 993 , Mlocked : 0 , NFS_Unstable : 0 , PageTables : 18 , SReclaimable : 145 , SUnreclaim : 31 , Shmem : 18 , Slab : 176 , SwapCached : 1 , SwapFree : 1013 , SwapTotal : 1024 , Unevictable : 0 , VmallocChunk : 33554424 , VmallocTotal : 33554432 , VmallocUsed : 6 , Writeback : 0 , WritebackTmp : 0 }, release : NethServer release 7.5.1804 (final) , uptime : { days : 0 , hours : 1 , minutes : 34 , seconds : 42 } } }","title":"Output"},{"location":"api/system-task/","text":"system-task Check if there is a running event. read Output If no running tasks is found, just output: { steps : -1 , event : null , message : no running tasks } Otherwise output the following once per second, until the event has been terminated: { steps : -1 , pid : 15018 , args : arg1 arg2 , event : nethserver-event-name } If steps has value equal to -1 , the system can't determinate the progress of the running event.","title":"system-task"},{"location":"api/system-task/#system-task","text":"Check if there is a running event.","title":"system-task"},{"location":"api/system-task/#read","text":"","title":"read"},{"location":"api/system-task/#output","text":"If no running tasks is found, just output: { steps : -1 , event : null , message : no running tasks } Otherwise output the following once per second, until the event has been terminated: { steps : -1 , pid : 15018 , args : arg1 arg2 , event : nethserver-event-name } If steps has value equal to -1 , the system can't determinate the progress of the running event.","title":"Output"},{"location":"api/system-time/","text":"system-time Configure server date and time. read Return the current date and time along with chronyd configuration. If chronyd status is disabled, the time configuration is manual. Example: { status : { datetime : Wed Sep 5 15:28:59 GMT 2018 , date : 2018-09-10 , time : 10:07 }, configuration : { chronyd : { props : { UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , timezones : [ Africa/Abidjan , Africa/Accra , ... UTC ] } } validate Constraints chronyd and timezone field from read input if chronyd status is disabled, the keys named date and time must contain the a valid time ( HH:MM ) and date ( YYYY-MM-DD ). Input Example: { chronyd : { props : { UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , time : 10:33 , date : 2018-09-06 } Invocation example: echo { chronyd :{ props :{ UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , time : 10:33 , date : 2018-09-06 } | ./validate update Set current timezone and chronyd configuration. If chronyd is disabled, date and time is set to manual input values. Tries also to set PHP timezone (fails silently). Same input as validate helper.","title":"system-time"},{"location":"api/system-time/#system-time","text":"Configure server date and time.","title":"system-time"},{"location":"api/system-time/#read","text":"Return the current date and time along with chronyd configuration. If chronyd status is disabled, the time configuration is manual. Example: { status : { datetime : Wed Sep 5 15:28:59 GMT 2018 , date : 2018-09-10 , time : 10:07 }, configuration : { chronyd : { props : { UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , timezones : [ Africa/Abidjan , Africa/Accra , ... UTC ] } }","title":"read"},{"location":"api/system-time/#validate","text":"","title":"validate"},{"location":"api/system-time/#constraints","text":"chronyd and timezone field from read input if chronyd status is disabled, the keys named date and time must contain the a valid time ( HH:MM ) and date ( YYYY-MM-DD ).","title":"Constraints"},{"location":"api/system-time/#input","text":"Example: { chronyd : { props : { UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , time : 10:33 , date : 2018-09-06 } Invocation example: echo { chronyd :{ props :{ UDPPort : 123 , NTPServer : pool.ntp.org , status : enabled , access : green }, name : chronyd , type : service }, timezone : Africa/Monrovia , time : 10:33 , date : 2018-09-06 } | ./validate","title":"Input"},{"location":"api/system-time/#update","text":"Set current timezone and chronyd configuration. If chronyd is disabled, date and time is set to manual input values. Tries also to set PHP timezone (fails silently). Same input as validate helper.","title":"update"},{"location":"api/system-tls-policy/","text":"system-tls-policy Read ans set tls configuration record. read Output The tls record is returned inside the configuration field. { status : { available : [ 20180621 , 20180330 ] }, configuration : { props : { policy : 20180621 }, name : tls , type : configuration } } validate Constraints policy must be: 20180330 , 20180621 if a custom ecda certificate is set, check if current policy supports it Input The input must be an esmith record in JSON format. Input example: { props : { policy : 20180621 }, name : tls , type : configuration } Invocation example: echo { props :{ policy : 20180621 }, name : tls , type : configuration } | ./validate update The same from validate helper.","title":"system-tls-policy"},{"location":"api/system-tls-policy/#system-tls-policy","text":"Read ans set tls configuration record.","title":"system-tls-policy"},{"location":"api/system-tls-policy/#read","text":"","title":"read"},{"location":"api/system-tls-policy/#output","text":"The tls record is returned inside the configuration field. { status : { available : [ 20180621 , 20180330 ] }, configuration : { props : { policy : 20180621 }, name : tls , type : configuration } }","title":"Output"},{"location":"api/system-tls-policy/#validate","text":"","title":"validate"},{"location":"api/system-tls-policy/#constraints","text":"policy must be: 20180330 , 20180621 if a custom ecda certificate is set, check if current policy supports it","title":"Constraints"},{"location":"api/system-tls-policy/#input","text":"The input must be an esmith record in JSON format. Input example: { props : { policy : 20180621 }, name : tls , type : configuration } Invocation example: echo { props :{ policy : 20180621 }, name : tls , type : configuration } | ./validate","title":"Input"},{"location":"api/system-tls-policy/#update","text":"The same from validate helper.","title":"update"},{"location":"api/system-trusted-networks/","text":"system-trusted-networks Manage trusted networks records from networks db. read Input Return all current configured records from /usr/libexec/nethserver/trusted-networks inside the status field. Return all network records from networks database inside the `configuration field. { status : [ { provider : green , cidr : 192.168.1.0/24 , mask : 192.168.1.0/255.255.255.0 }, { provider : networksdb , cidr : 10.0.0.0/24 , mask : 10.0.0.0/255.255.255.0 } ], configuration : [ { props : { Mask : 255.255.255.0 , Description : my trusted net }, name : 10.0.0.0 , type : network } ] } validate Constraints the key ( name field) must be a valid IPv4 address Mask must be a valid IPv4 netmask the combination of name and Mask must be a valid network the network should not be used inside the system, for example on a network interface Input A network esmith db record in JSON format. The record must also contain an action fields which can be: - create for new dns record creation - update when updating and existing record Example: { props : { Mask : 255.255.255.0 , Description : my net 11 }, name : 11.0.0.0 , type : network , action : update } update Use the same input from validate. create Use the same input from validate. delete Pass the the key to be deleted inside the name field. Example: { name : 11.0.0.0 , action : delete } Invocation example: echo { name : 11.0.0.0 , action : delete } | ./delete","title":"system-trusted-networks"},{"location":"api/system-trusted-networks/#system-trusted-networks","text":"Manage trusted networks records from networks db.","title":"system-trusted-networks"},{"location":"api/system-trusted-networks/#read","text":"","title":"read"},{"location":"api/system-trusted-networks/#input","text":"Return all current configured records from /usr/libexec/nethserver/trusted-networks inside the status field. Return all network records from networks database inside the `configuration field. { status : [ { provider : green , cidr : 192.168.1.0/24 , mask : 192.168.1.0/255.255.255.0 }, { provider : networksdb , cidr : 10.0.0.0/24 , mask : 10.0.0.0/255.255.255.0 } ], configuration : [ { props : { Mask : 255.255.255.0 , Description : my trusted net }, name : 10.0.0.0 , type : network } ] }","title":"Input"},{"location":"api/system-trusted-networks/#validate","text":"","title":"validate"},{"location":"api/system-trusted-networks/#constraints","text":"the key ( name field) must be a valid IPv4 address Mask must be a valid IPv4 netmask the combination of name and Mask must be a valid network the network should not be used inside the system, for example on a network interface","title":"Constraints"},{"location":"api/system-trusted-networks/#input_1","text":"A network esmith db record in JSON format. The record must also contain an action fields which can be: - create for new dns record creation - update when updating and existing record Example: { props : { Mask : 255.255.255.0 , Description : my net 11 }, name : 11.0.0.0 , type : network , action : update }","title":"Input"},{"location":"api/system-trusted-networks/#update","text":"Use the same input from validate.","title":"update"},{"location":"api/system-trusted-networks/#create","text":"Use the same input from validate.","title":"create"},{"location":"api/system-trusted-networks/#delete","text":"Pass the the key to be deleted inside the name field. Example: { name : 11.0.0.0 , action : delete } Invocation example: echo { name : 11.0.0.0 , action : delete } | ./delete","title":"delete"}]}